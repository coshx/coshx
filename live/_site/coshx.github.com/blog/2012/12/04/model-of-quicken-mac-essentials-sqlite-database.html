<p> A rough model of Quicken Mac Essentials sqlite database using ActiveRecord without rails</p>

<h2>Setup:</h2>

<ul>
<li>Ruby 1.9.3 on OSX</li>
<li>gem install activerecord</li>
<li>gem install sqlite</li>
<li>Copy the sqlite file containing your transactions into a local working directory.  <br>
The sqlite file is appropriately named data and within the user file (for example mydata.quickendata/data).</li>
<li>Copy and paste the ruby script below into script.rb which should be contained within the same local working directory as the copy of the database file.</li>
</ul>


<h2>To Run (prints transactions):</h2>

<ul>
<li>ruby script.rb</li>
</ul>


<p>```ruby</p>

<h1>script.rb</h1>

<p>require 'active_record'</p>

<p>ActiveRecord::Base.establish_connection(
  :adapter => "sqlite3",
  :database => "data"
)</p>

<p>class FIPayee &lt; ActiveRecord::Base
  self.table_name =  "ZFIPAYEE"
  def name</p>

<pre><code>self.ZNAME
</code></pre>

<p>  end
end</p>

<p>class Payee &lt; ActiveRecord::Base
  self.table_name =  "ZUSERPAYEE"
  def name</p>

<pre><code>self.ZNAME
</code></pre>

<p>  end
end</p>

<p>class Account &lt; ActiveRecord::Base
  self.table_name =  "ZACCOUNT"
  def name</p>

<pre><code>self.ZNAME
</code></pre>

<p>  end
end</p>

<p>class Category &lt; ActiveRecord::Base
  self.table_name =  "ZTAG"
  def name</p>

<pre><code>self.ZNAME
</code></pre>

<p>  end
  def parent</p>

<pre><code>self.ZPARENTCATEGORY
</code></pre>

<p>  end
end</p>

<p>class CategoryTransaction &lt; ActiveRecord::Base
  self.table_name =  "ZCASHFLOWTRANSACTIONENTRY"</p>

<p>  def category_id</p>

<pre><code>self.ZCATEGORYTAG
</code></pre>

<p>  end</p>

<p>  def transaction_id</p>

<pre><code>self.ZPARENT
</code></pre>

<p>  end
end</p>

<p>class Transaction &lt; ActiveRecord::Base
  self.table_name = "ZTRANSACTION"</p>

<p>  def amount</p>

<pre><code>self.ZAMOUNT.round(2)
</code></pre>

<p>  end</p>

<p>  def account_id</p>

<pre><code>self.ZACCOUNT
</code></pre>

<p>  end</p>

<p>  def payee_id</p>

<pre><code>self.ZUSERPAYEE
</code></pre>

<p>  end</p>

<p>  def fipayee_id</p>

<pre><code>self.ZFIPAYEE
</code></pre>

<p>  end</p>

<p>  def date</p>

<pre><code>posted_date || entered_date
</code></pre>

<p>  end</p>

<p>  private
  def posted_date</p>

<pre><code>return nil if self.ZPOSTEDDATE.nil?
Time.at(self.ZPOSTEDDATE+978307200).strftime("%Y-%m-%d")
</code></pre>

<p>  end</p>

<p>  def entered_date</p>

<pre><code>return nil if self.ZENTEREDDATE.nil?
Time.at(self.ZENTEREDDATE+978307200).strftime("%Y-%m-%d")
</code></pre>

<p>  end</p>

<p>end</p>

<h1>use model to print transactions to screen.</h1>

<p>CategoryTransaction.find(:all).each do |ct|
  begin</p>

<pre><code>transaction = Transaction.find(ct.transaction_id)
category = Category.find(ct.category_id).name
account = Account.find(transaction.account_id).name
date = transaction.date
amount = transaction.amount
payee = String.new
if !transaction.payee_id.nil?
  payee = Payee.find(transaction.payee_id).name[0..30]
else
  payee = FIPayee.find(transaction.fipayee_id).name[0..30]
end
puts "#{account}, #{date}, #{amount}, #{category}, #{payee}"
</code></pre>

<p>  rescue ActiveRecord::RecordNotFound => e ;</p>

<pre><code>puts ct.inspect 
</code></pre>

<p>  end
end</p>

<p>```</p>
